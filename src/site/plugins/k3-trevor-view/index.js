!function(){"use strict";document.querySelector("svg defs").innerHTML+='\n  <symbol id="icon-trevor" viewBox="0 0 1024 1024">\n    <path d="M851.8 516.4h-30.4V380c0-7.8-6.3-14.1-14.1-14.1H456.9c-7.8 0-14.1 6.3-14.1 14.1v104.9c-7.8-10.7-18.3-19.2-30.6-24.4V76.1c0-17-13.8-30.8-30.8-30.8H148.7c-17 0-30.8 13.8-30.8 30.8v420.7c0 17 13.8 30.8 30.8 30.8h162.6c0 37.8 29 68.5 65.8 72.2h-0.1v309.5c0 25.9 21 46.8 46.8 46.8h416.6c25.9 0 46.8-21 46.8-46.8V551.8c0-19.5-15.9-35.4-35.4-35.4z m-512.3 11.2c0-24.6 20-44.7 44.7-44.7 10.7 0 20.4 3.8 28 10.1 7.2 5.9 12.6 14.1 15.1 23.4 0.9 3.6 1.6 7.3 1.6 11.2 0 22.3-16.5 40.6-37.8 44-2.3 0.4-4.5 0.7-6.9 0.7-24.6-0.1-44.7-20.1-44.7-44.7z m453.6-11.2H471V394.1h322.1v122.3z" />\n    <path d="M565.6 421.7h28.2v66.4h-28.2zM625 421.7h28.2v66.4H625zM684.4 421.7h28.2v66.4h-28.2zM759.7 267.1c0-0.5-0.1-1-0.1-1.5-3.6-38-24.9-155.5-153.6-191.1 0 0 29.7 37.7-50 121.8-4.6 4.1-8.9 8.4-12.8 13.1-0.1 0.1-0.1 0.2-0.2 0.2-15.6 18.9-25 42.4-25 67.9 0 61.8 54.2 112 121.1 112s121.1-50.1 121.1-112c0 0.1 0-3.8-0.5-10.4z" />\n  </symbol>\n';var e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("k-inside",[n("k-view",{staticClass:"trevor"},[n("k-header",{staticClass:"heading"},[e._v(e._s(e.$t("trevor.heading")))]),n("div",{staticClass:"editor"},[n("div",{staticClass:"keys",on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.selectNext.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.selectPrev.apply(null,arguments)}]}},e._l(e.languagekeys,(function(t){return n("div",{key:t,ref:"keyspane",refInFor:!0,class:["key",{selected:e.selected==t,edited:e.edited.has(t)}],attrs:{tabindex:"-1"},on:{click:function(n){return e.selectOne(t)}}},[n("div",{staticClass:"txt"},[e._v(e._s(t))]),e.missing.has(t)?n("div",{staticClass:"missing"}):e._e()])})),0),n("div",{staticClass:"ctrl"},[e.addKeys?n("k-button",{attrs:{icon:"add"},on:{click:e.add}},[e._v(e._s(e.$t("add")))]):e._e()],1),n("div",{staticClass:"texts"},[e.selected?n("div",{on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:t.ctrlKey?e.selectPrev.apply(null,arguments):null},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:t.ctrlKey?e.selectNext.apply(null,arguments):null}]}},e._l(e.languages,(function(t){var s=t[0],i=t[1];return n("div",{key:s,staticClass:"lang"},[n("k-textarea-field",{ref:"input_"+s,refInFor:!0,attrs:{buttons:!1,label:i.name+(i.default?" *":"")},on:{input:function(t){return e.edited.add(e.selected)}},model:{value:i.translations[e.selected],callback:function(t){e.$set(i.translations,e.selected,t)},expression:"lang.translations[selected]"}})],1)})),0):n("div",{staticClass:"no-selection"},[n("div",{staticClass:"text"},[n("p",[e._v(e._s(e.$t("trevor.startinfo")))]),n("p",[n("b",[e._v("Trevor")]),e._v(": "+e._s(e.$t("trevor.payoff")))])])])])]),e.edited.size?n("div",{staticClass:"savebar"},[n("k-view",[n("k-button",{attrs:{icon:"undo"},on:{click:e.revert}},[e._v(e._s(e.$t("revert")))]),n("k-button",{attrs:{icon:"check"},on:{click:e.save}},[e._v(e._s(e.$t("save")))])],1)],1):e._e()],1)],1)};function t(e,t,n,s,i,a,o,r){var l,d="function"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=n,d._compiled=!0),s&&(d.functional=!0),a&&(d._scopeId="data-v-"+a),o?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},d._ssrRegister=l):i&&(l=r?function(){i.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:i),l)if(d.functional){d._injectStyles=l;var c=d.render;d.render=function(e,t){return l.call(t),c(e,t)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,l):[l]}return{exports:e,options:d}}const n={props:{addKeys:{type:Boolean,default:!0}},computed:{languagekeys(){const e=new Set;for(let[t,n]of this.languages)Object.keys(n.translations).forEach((t=>e.add(t)));return Array.from(e)},missing(){const e=new Set;for(let t of this.languagekeys)for(let[n,s]of this.languages)void 0!==s.translations[t]&&""!==s.translations[t].trim()||e.add(t);return e}},data:function(){return{edited:new Set,languages:[],selected:null}},created:function(){this.fetch(),this.$events.$on("keydown.cmd.s",this.onCmdS)},destroyed:function(){this.$events.$off("keydown.cmd.s",this.onCmdS)},methods:{fetch(){this.$api.get("trevor/languages").then((e=>{this.languages=Object.entries(e).sort((([e,t],[n,s])=>t.default?-1:s.default?1:e.localeCompare(n)))}))},add(){let e=window.prompt(this.$t("trevor.addkey"));e&&(e=e.toLowerCase(),-1===this.languagekeys.indexOf(e.trim())&&(this.languages.length&&this.$set(this.languages[0][1].translations,e,""),this.edited.add(e)),this.$nextTick((()=>this.selectOne(e))))},selectOne(e){this.selected=e;const t=this.languagekeys.indexOf(e);this.$refs.keyspane[t].scrollIntoView({block:"nearest"}),this.$nextTick((()=>{for(let[t,n]of this.languages)if(void 0===n.translations[e]||""===n.translations[e].trim()){let e=null;if(e=this.$refs[`input_${t}`])return void e[0].focus()}}))},selectPrev(){const e=this.languagekeys.indexOf(this.selected),t=Math.max(0,e-1);this.selectOne(this.languagekeys[t])},selectNext(){const e=this.languagekeys.indexOf(this.selected),t=Math.min(this.languagekeys.length-1,e+1);this.selectOne(this.languagekeys[t])},onCmdS(e){e.preventDefault(),this.save()},save(){if(0===this.edited.size)return;const e={};for(let[t,n]of this.languages){e[t]={};for(let s of this.edited)e[t][s]=n.translations[s]}this.$api.patch("trevor/languages/translations",e).then(this.fetch),this.edited=new Set},revert(){this.languages=[],this.edited=new Set,this.fetch()}}},s={};var i=t(n,e,[],!1,a,"ac8ba862",null,null);function a(e){for(let t in s)this[t]=s[t]}var o=function(){return i.exports}();panel.plugin("rasteiner/k3-trevor-view",{components:{"k-trevor-view":o}})}();
